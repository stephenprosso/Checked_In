 <script>
 
    document.addEventListener('DOMContentLoaded', function() {
    
      //add event listner to the btn. when user clicks it will call the function add name
      document.getElementById("btn").addEventListener("click",btnClickAction);
      document.getElementById("btnAddMulti").addEventListener("click",btnClickAddMulti);
    
    }); 
    
    
    
    
/*    function btnClickAddMulti() {
    
    
    var userInput = document.getElementById("multiName").value;
    var names = userInput.split("\n").forEach(function() {
    
      var multiNames = {};
      
      
  
          multiNames.name = names[1];
         var fnl = multiNames.name.split(" ");
          multiNames.first = fnl[0];
          multiNames.last = fnl[1];
        
        
        document.getElementById("multiNameOutput").innerHTML = multiNames.first + multiNames.last;
   
    
    
   
        
         console.log(multiNames);
       
          google.script.run.addMultiNames(multiNames);
    
    
      });
    
    
    } */
    

    
    function btnClickAddMulti() {
    
   var ctype = document.getElementById("credType").value;
   var eventID  = document.getElementById("eventList").value;
   var org  = document.getElementById("organization").value;
       
    var userInput = document.getElementById("multiName").value.trim();
    var names = userInput.split("\n");
    var data = [];
    names.forEach(function(n){
       var combinedName = n.split(" ");
       
       data.push([combinedName[0],combinedName[1],ctype,org,eventID]);
    
    });
    console.log(data);
    google.script.run.addMultiNames(data);
  
    }
    
 // var displayDateArray = dateText.split(' ');
     //Logger.log(displayDateArray);
        //var displayDate = displayDateArray[0] + ' ' + displayDateArray[1] + ' ' + displayDateArray[2];
           
 
    function btnClickAction() {
       var toValidate = {
         firstName: "First Name Required",
         lastNname: "Last Name Required",
         credType: "Cred Type Required",
         eventList: "Select Event Required"     
       };
      
       var idKeys = Object.keys(toValidate);
       
       var allValid = true;
       idKeys.forEach(function(id){
        var isValid =  checkIfValid(id, toValidate[id]);
             if (!isValid) {
             
             allValid = false;
             }
       });
       
             if(allValid) {
             
           addName();
       }
    
    } //close function btnclick
    //.is-invalid and .is-valid  
    function checkIfValid(elID, message) {
      var elToValidate = document.getElementById(elID);
      var isValid = false;
      console.log("Styart validating");
      console.log(elToValidate.tagName);
      switch(elToValidate.tagName) {
       
              case "INPUT":
                  isValid = elToValidate.checkValidity();
                  isValid ? elToValidate.classList.remove("is-invalid") : elToValidate.classList.add("is-invalid");
                break;
              case "SELECT":
                  isValid = elToValidate.selectedIndex === 0 ? false : true;
                  isValid ? elToValidate.classList.remove("is-invalid") : elToValidate.classList.add("is-invalid");
                break;
              default:
                // code block
            }
      
     return isValid;
    
    } // close function CheckIfValid
    function addName(){
          var userInfo = {};
          
          userInfo.fname = document.getElementById("firstName").value;
          userInfo.lname = document.getElementById("lastNname").value;
          userInfo.ctype = document.getElementById("credType").value;
          userInfo.eventID  = document.getElementById("eventList").value;
          userInfo.org  = document.getElementById("organization").value;
       
          //console.log(userInfo.eventID);
          userInfo.checkinDate = '';
          userInfo.checkBox = false;
       
          //run the user click pass the array of data.
          google.script.run.userClick(userInfo);
          //clear the fields
          document.getElementById("firstName").value = "";
          document.getElementById("lastNname").value = "";
          document.getElementById("organization").value = "";
          //create cred type as a varialbe
          var credTypeSelect = document.getElementById("credType");
          //set selected index to 0 after data submitted
          credTypeSelect.selectedIndex = 0;
           var guestListSelect = document.getElementById("eventList");
          //set selected index to 0 after data submitted
          guestListSelect.selectedIndex = 0; 
    }
    
    </script>
